function debug(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];t?GameConst.isNative()?egret.log.apply(egret,["nav-sdk-lgzb:"+e].concat(t)):egret.log.apply(egret,[e].concat(t)):GameConst.isNative()?egret.log("nav-sdk-lgzb:"+e):egret.log(e)}function sayError(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o]}function Po(e,t){return new egret.Point(e,t)}function Po2(e,t){return{x:e,y:t}}function Po3(e,t,o){return{x:e,y:t,k:o}}var __reflect=this&&this.__reflect||function(e,t,o){e.__class__=t,o?o.push(t):o=[t],e.__types__=e.__types__?o.concat(e.__types__):o},__extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,o){function n(n){t.call(o,n,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?n(r):RES.getResAsync(e,n,this)}else RES.getResByUrl(e,n,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var AGame;!function(e){var t=function(){function t(){}return t.clear=function(){this.client=null,this.m_bLoaded=!1,this.m_bLoginSocket=!1},t.startup=function(t){this.client=t,debug("初始化client"),e.R.startup(this.client),this.onLoginDataComplete()},t.onTouchEnd=function(e){},t.onLoginDataComplete=function(){debug("onLoginSocket"),this.m_bLoginSocket=!0,this.enterGame()},t.onResComplete=function(){debug("onResComplete"),this.m_bLoaded=!0,this.enterGame()},t.enterGame=function(){if(this.m_bLoginSocket&&this.m_bLoaded){debug("进入游戏"),this.client.removeControl();var t=new MainMenu;e.R.app.menuLevel.addChild(t),t.startCreateScene()}},t.onResize=function(e){debug("onResize event",e)},t.m_bLoginSocket=!1,t.m_bLoaded=!1,t}();e.GameMain=t,__reflect(t.prototype,"AGame.GameMain")}(AGame||(AGame={}));var LoadingEnum;!function(e){e[e.ResConfig=1]="ResConfig",e[e.Proto=2]="Proto",e[e.Code=3]="Code",e[e.Theme=4]="Theme",e[e.Resource=5]="Resource",e[e.UserLogin=6]="UserLogin"}(LoadingEnum||(LoadingEnum={}));var AGame;!function(e){var t=function(){function t(e){this.m_bIsGameCodeStartUp=!1,this.m_pMain=e,this.m_iStartTime=(new Date).getTime(),t.IS_LOADING=!0,this.initGameStartConf()}return t.prototype.initGameStartConf=function(){this.m_pLoadCfg=[],this.m_pLoadCfg[LoadingEnum.ResConfig]=0,this.m_pLoadCfg[LoadingEnum.Proto]=0,this.m_pLoadCfg[LoadingEnum.Code]=0,this.m_pLoadCfg[LoadingEnum.Theme]=0,this.m_pLoadCfg[LoadingEnum.Resource]=0,this.m_pLoadCfg[LoadingEnum.UserLogin]=0},t.prototype.createLoginView=function(){this.m_pLoadView=new e.LoadingUI(this),this.m_pLoadView.viewWidth=this.m_pMain.stage.stageWidth,this.m_pLoadView.width=this.m_pMain.stage.stageWidth,this.m_pMain.addChild(this.m_pLoadView),this.m_pLoadView.showView()},t.prototype.setComplete=function(e){if(this.m_pLoadCfg){this.m_pLoadCfg[e]=1,debug("setComplete",e,LoadingEnum[e]),debug("耗时:"+e+":"+((new Date).getTime()-this.m_iStartTime)),e!=LoadingEnum.Proto||GameConst.isShowLogin||this.userLogin(),this.m_bIsGameCodeStartUp||this.m_pLoadCfg[LoadingEnum.UserLogin]&&this.m_pLoadCfg[LoadingEnum.Code]&&this.m_pLoadCfg[LoadingEnum.Proto]&&this.m_pLoadCfg[LoadingEnum.Theme]&&(this.m_bIsGameCodeStartUp=!0,this.onGameCodeStartUp(),this.doLoadResource());var t=!0;for(var o in this.m_pLoadCfg)0==this.m_pLoadCfg[o]&&(t=!1);t&&this.doEnterGame()}},t.prototype.userLogin=function(){e.PlatformUtils.userLogin(this.onCallUserInfo,this)},t.prototype.onCallUserInfo=function(e){if(debug("onCallUserInfo",e),0==e.code){GameConst.sign=e.token,GameConst.serverId=0==e.servers.last_login_sid?e.servers.rate_sid:e.servers.last_login_sid;var t=e.servers.rate_sid,o=null;GameConst.IsWhite=1==e.servers.is_white;for(var n=!1,r=0;r<e.servers.server_list.length;r++){var i=e.servers.server_list[r];if(i.id==GameConst.serverId){if(n=!0,GameConst.serverIp=i.host,GameConst.serverPort=i.port,this.checkServerIsUpdate(i))return}else i.id==t&&(o=i)}n||(GameConst.serverId=o.id,GameConst.serverIp=o.host,GameConst.serverPort=o.port),this.doSelectServer()}else debug("登录失败")},t.prototype.doSelectServer=function(){var t=e.LocalData.getServerId();GameConst.serverId!=t?e.PlatformUtils.getServerList(this.onCallServerList,this):this.setComplete(LoadingEnum.UserLogin)},t.prototype.onCallServerList=function(t){debug("onCallServerList",t);for(var o,n,r=Number(e.LocalData.getServerId()),i=GameConst.serverId,s=0;s<t.server_list.length;s++){var a=t.server_list[s];a.id==r?o=a:a.id==i&&(n=a)}var p=o||n;GameConst.serverId=p.id,GameConst.serverIp=p.host,GameConst.serverPort=p.port,e.LocalData.setServerId(GameConst.serverId),this.checkServerIsUpdate(p)||this.setComplete(LoadingEnum.UserLogin)},t.prototype.checkServerIsUpdate=function(t){if(0!=t.is_update){var o=new e.NoticeView;return o.showNotice(t.is_update_msg),o.x=this.m_pMain.width/2,o.y=this.m_pMain.height/2,this.m_pMain.addChild(o),!0}return!1},t.prototype.onGameCodeStartUp=function(){var t=e.GameMain;t.startup(this.m_pMain)},t.prototype.doEnterGame=function(){var t=e.GameMain;t.onResComplete()},t.prototype.doLoadResource=function(){var t=[["common",0],["main",1],["map_base",1],["json",1]];e.ResUtils.loadGroups(t,this.onResourceLoadComplete,this.onResourceLoadProgress,this)},t.prototype.onResourceLoadComplete=function(e){"common"==e&&this.setComplete(LoadingEnum.Resource)},t.prototype.onResourceLoadProgress=function(e,t){},t.prototype.clearAll=function(){t.IS_LOADING=!1,this.m_pLoadView&&(this.m_pLoadView.onDestroy(),this.m_pLoadView=null),this.m_bIsGameCodeStartUp=!1,this.m_pMain=null,this.m_pLoadCfg=[],this.m_pLoadCfg=null},t}();e.LoadControl=t,__reflect(t.prototype,"AGame.LoadControl")}(AGame||(AGame={}));var AGame;!function(e){var t=function(t){function o(e){var o=t.call(this)||this;return o.m_pStopLoader=!1,o.m_pLoadRes=!1,o.viewWidth=0,o.skinName=o.getSkinXml(),o.m_pLoadControl=e,o}return __extends(o,t),o.prototype.stopLoader=function(){clearTimeout(this.m_timerHandle),this.m_pStopLoader=!0},o.prototype.$onRemoveFromStage=function(e){void 0===e&&(e=!0),this.stopLoader(),t.prototype.$onRemoveFromStage.call(this),this.setSkin(null)},o.prototype.onDestroy=function(){this.stopLoader(),this.btn_login.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onUserLogin,this),this.parent.removeChild(this)},o.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.width=this.viewWidth,this.m_pPwd.displayAsPassword=!0,this.m_pEdition.text="Ver."+GameConst.Packaged_Version,this.setProgress(0,0),this.m_pAccount.text=e.LocalData.getOpenId(),this.btn_login.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onUserLogin,this)},o.prototype.showView=function(){GameConst.isShowLogin?(egret.setTimeout(function(){e.NativeHelper.sendEnterGame("enter")},this,1e3),this.m_pProgressGroup.visible=!1,this.Group_Login.visible=!0):(this.Group_Login.visible=!1,this.simulationLoad(500))},o.prototype.onUserLogin=function(){var t=this.m_pAccount.text;this.m_pPwd.text;return""==t?void e.CMessageTip.AddMessageError(this,"请输入账号"):(this.Group_Login.visible=!1,this.simulationLoad(500),e.LocalData.setOpenId(t),void this.m_pLoadControl.userLogin())},o.prototype.setProgress=function(e,t){if(0==e)this.m_pProgressImg.width=0;else{e>t&&(e=t);var o=e/t;this.m_pProgressGroup&&(this.m_pProgressImg.width=this.m_pProgressGroup.width*o)}e>=.5*t&&0!=t&&0==this.m_pLoadRes&&(this.m_pLoadRes=!0),this.m_pProgressImg&&(this.m_pProgressStar.x=this.m_pProgressImg.width-6,this.m_pProgressStar.visible=this.m_pProgressStar.x>=10,this.m_pProgressImg.visible=this.m_pProgressStar.x<=960,this.m_pProgressStar.x>960&&(this.m_pProgressStar.visible=!1))},o.prototype.simulationLoad=function(e,t,o,n){void 0===t&&(t=5),this.m_pProgressGroup.visible=!0,this.stopLoader(),this.m_pStopLoader=!1;var r=this,i=0,s=function(){r.setProgress(i,e),r.m_pStopLoader||(i++<e?this.m_timerHandle=setTimeout(s,t):(r.setProgress(0,500),r.m_pStopLoader=!1,r.simulationLoad(500)))};this.m_timerHandle=setTimeout(s,t)},o.prototype.showLogin=function(){this.showProgress(!1),this.stopLoader()},o.prototype.showProgress=function(e){void 0===e&&(e=!0),this.m_pProgressGroup.visible=e},o.prototype.getSkinXml=function(){return'<?xml version=\'1.0\' encoding=\'utf-8\'?>\n<e:Skin class="LoginSkin" width="1334" height="750" xmlns:e="http://ns.egret.com/eui" xmlns:w="http://ns.egret.com/wing"  xmlns:ns1="*">\n	<e:Image xmlns:com_main="com_main.*" horizontalCenter="0" verticalCenter="0" width="100%" height="100%" source="loading_bg_jpg"/>\n	<e:Group id="m_pProgressGroup" horizontalCenter="0" y="618" width="981" height="43">\n		<e:Image xmlns:com_main="com_main.*" source="loading_jd_di_png" horizontalCenter="0" verticalCenter="0"/>\n		<e:Group id="m_pProgressImg" width="500" height="22" verticalCenter="0" scrollEnabled="true" anchorOffsetX="0" left="9">\n			<e:Image scaleX="1" scaleY="1" source="loading_jd_2_png" x="0" y="0"/>\n		</e:Group>\n		<e:Image id="m_pProgressStar" x="500" source="loading_jd_1_png" verticalCenter="0.5" anchorOffsetX="0"/>\n	</e:Group>\n	<e:Label xmlns:ns1="*" id="m_pTip1" text="抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防受骗上当" size="22" y="678.28" stroke="1" textColor="0xe6ddcf" horizontalCenter="0"/>\n	<e:Label xmlns:ns1="*" id="m_pTip2" size="22" text="适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活" y="709" stroke="1" textColor="0xe6ddcf" horizontalCenter="0"/>\n	<e:Label id="m_pEdition" text="Ver.20170415" size="22" textColor="0xc9c6b8" width="150" textAlign="right" y="709" right="10"/>\n	<e:Image width="20" height="20" x="76" y="360"/>\n	<e:Group id="Group_Login" width="984" height="390" anchorOffsetX="0" horizontalCenter="0" verticalCenter="0" visible="false">\n		<e:Image horizontalCenter="0" verticalCenter="0" source="loading_di_png"/>\n		<e:Image x="222" y="106.42" source="loading_acc_png"/>\n		<e:Image x="373" y="94.48" source="loading_input_bg_png"/>\n		<e:EditableText id="m_pAccount" width="366" height="60" text="" x="393" y="106.36" size="56" textColor="0xf1f1f1" maxChars="15"/>\n		<e:Image x="223.43" y="167.94" source="loading_pwd_png" visible="false"/>\n		<e:Image x="373" y="156.06" source="loading_input_bg_png" visible="false"/>\n		<e:EditableText id="m_pPwd" width="366" height="60" text="" x="393" y="167.88" size="56" textColor="0xF1F1F1" maxChars="15" inputType="password" visible="false"/>\n		<e:Group id="btn_login" width="383" height="104" y="256.45" horizontalCenter="0.5">\n			<e:Image scaleX="1" scaleY="1" horizontalCenter="0" verticalCenter="0" source="loading_btn_png"/>\n			<e:Label text="进入游戏" size="56" horizontalCenter="0" verticalCenter="0" textColor="0xcfddfd"/>\n		</e:Group>\n	</e:Group>\n</e:Skin>'},o}(eui.Component);e.LoadingUI=t,__reflect(t.prototype,"AGame.LoadingUI")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function t(){}return t.startup=function(e){this.initialize(),e&&this.m_pApp.registerView(e)},Object.defineProperty(t,"app",{get:function(){return this.m_pApp},enumerable:!0,configurable:!0}),Object.defineProperty(t,"router",{get:function(){return this.m_pRouter},enumerable:!0,configurable:!0}),t.initialize=function(){this.m_pApp||(this.m_pApp=e.App.Instance),this.m_pRouter||(this.m_pRouter=e.Router.Instance)},t.registerRouter=function(e,t){this.m_pRouter.registerRouter(e,t)},t.notifyObservers=function(e){this.m_pRouter&&this.m_pRouter.notifyObservers(e)},t.notifyView=function(t,o,n){this.notifyObservers(new e.Notification(t,o,n))},t}();e.R=t,__reflect(t.prototype,"AGame.R")}(AGame||(AGame={}));var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,o,n){function r(e){t.call(n,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),o.call(n))}0!=e.length&&(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var AGame;!function(e){var t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.registerView=function(e){this.m_pRoot=e,this.m_pMapLevel=new egret.DisplayObjectContainer,this.m_pMapLevel.name="map",this.m_pRoot.addChild(this.m_pMapLevel),this.m_pMenuLevel=new egret.DisplayObjectContainer,this.m_pMenuLevel.name="menu",this.m_pMenuLevel.height=this.stageHeight,this.m_pRoot.addChild(this.m_pMenuLevel),this.m_pPopupLevel=new egret.DisplayObjectContainer,this.m_pPopupLevel.name="popUp",this.m_pRoot.addChild(this.m_pPopupLevel),this.m_pTopLevel=new egret.DisplayObjectContainer,this.m_pTopLevel.name="top",this.m_pRoot.addChild(this.m_pTopLevel),this.m_pGuideLevel=new egret.DisplayObjectContainer,this.m_pGuideLevel.name="guide",this.m_pRoot.addChild(this.m_pGuideLevel)},t.prototype.setBattleEnv=function(e){this.m_pMapLevel.visible=!e,this.m_pMenuLevel.visible=!e},Object.defineProperty(t.prototype,"stageWidth",{get:function(){return this.m_pRoot.stage.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stageHeight",{get:function(){return this.m_pRoot.stage.stageHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"screenWidth",{get:function(){return t.isNative?egret.MainContext.instance.stage.stageWidth:this.m_pRoot.stage.$screen.canvas.clientWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"screenHeight",{get:function(){return t.isNative?egret.MainContext.instance.stage.stageHeight:this.m_pRoot.stage.$screen.canvas.clientHeight},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"renderBuffer",{get:function(){return this.m_pRoot.stage.$displayList.renderBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvas",{get:function(){return this.m_pRoot.stage.$screen.canvas},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stage",{get:function(){return this.m_pRoot.stage},enumerable:!0,configurable:!0}),t.prototype.removeAll=function(){this.m_pMapLevel.removeChildren(),this.m_pMenuLevel.removeChildren(),this.m_pPopupLevel.removeChildren(),this.m_pTopLevel.removeChildren(),this.m_pGuideLevel.removeChildren(),this.m_pRoot.removeChildren()},t.prototype.screenScale=function(e,t){var o=this.screenWidth/this.screenHeight,n=t/e,r=o/n+.1,i=o/1.5;return r>.95&&1>r&&(r=1>i?r-.1:.95),r>1?1:r},Object.defineProperty(t.prototype,"mapLevel",{get:function(){return this.m_pMapLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"menuLevel",{get:function(){return this.m_pMenuLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"popUpLevel",{get:function(){return this.m_pPopupLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topLevel",{get:function(){return this.m_pTopLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"guideLevel",{get:function(){return this.m_pGuideLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"menu",{get:function(){return this.m_pMenu},set:function(e){this.m_pMenu=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.m_pRoot},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"frameRate",{set:function(e){this.m_pRoot.stage.frameRate=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Instance",{get:function(){return t.instance||(t.instance=new t),t.instance},enumerable:!0,configurable:!0}),t.isNative=egret.Capabilities.runtimeType!=egret.RuntimeType.WEB,t}(egret.HashObject);e.App=t,__reflect(t.prototype,"AGame.App")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function e(){}return e.prototype.register=function(){},e.prototype.execute=function(e){},e.prototype.getView=function(e,t){var o=egret.getDefinitionByName(e),n=new o(t);return n},e}();e.Controller=t,__reflect(t.prototype,"AGame.Controller",["AGame.IController"])}(AGame||(AGame={}));var GameConst=function(){function e(){}return e.getServerId=function(){return e.DEBUG?9991:1},e.getConfigServer=function(){var e="";return e=this.DEBUG?this.testConfigHost:this.configHost,e+this.serverId},e.isNative=function(){return egret.RuntimeType.NATIVE==egret.Capabilities.runtimeType?!0:!1},e.deviceType=function(){if(this.isNative()){if("Android"==egret.Capabilities.os)return 1;if("iOS"==egret.Capabilities.os)return 2}return 0},e.VERSION="201708081710",e.Packaged_Version="1.0.5",e.asynchScripts=["main.min.js"],e.serverHost="http://test-lgzb-platform.allrace.com",e.configHost="http://cdn.lgzb.yaowan.com/resource/config/",e.isShowLogin=!0,e.DEBUG=!0,e.RES_SERVER_CNF="./resource/",e.isLoadFNT=!1,e.fontFamily="SimHei",e.IsWhite=!1,e.loginTime=0,e.createTime=0,e.sign="",e.platform="test",e.serverId=0,e.serverIp="",e.serverPort=0,e.CONTENT_WIDTH=1334,e.CONTENT_HEIGHT=750,e.testConfigHost="http://192.168.16.29:8080/loginserver/config/",e}();__reflect(GameConst.prototype,"GameConst");var AGame;!function(e){var t=function(){function e(){this.m_pDelay=0,this.m_pTimerComFunc=null,this.m_pSendDelay=0}return e.prototype.timer=function(e){this.m_pSendDelay+=e,this.m_pSendDelay>=this.m_pDelay&&(this.m_pSendDelay-=this.m_pDelay,this.m_pTimerComFunc&&this.m_pTimerComFunc.call(this.m_pTargert))},e.create=function(t,o,n){void 0===t&&(t=300);var r=new e;return r.m_pDelay=t,r.m_pTimerComFunc=o,r.m_pTargert=n,r},e}();e.ATimerEvent=t,__reflect(t.prototype,"AGame.ATimerEvent");var o=function(){function e(){}return e.timer=function(e){for(var t=0;t<this.m_pQueue.length;t++){var o=this.m_pQueue[t];o.timer(e)}},e.clear=function(){this.m_pQueue=[]},e.isExistKey=function(e){for(var t=0;t<this.m_pQueue.length;t++){var o=this.m_pQueue[t];if(o.name==e)return!0}return!1},e.removeTimerEventByName=function(e){for(var t=0;t<this.m_pQueue.length;t++){var o=this.m_pQueue[t];if(o.name==e){this.m_pQueue.splice(t,1);break}}},e.create=function(e,o,n,r){var i=t.create(e,o,n);i.name=r,this.m_pQueue.push(i)},e.m_pQueue=[],e}();e.HeartbeatQueue=o,__reflect(o.prototype,"AGame.HeartbeatQueue")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function e(e,t,o){void 0===t&&(t=null),void 0===o&&(o=null),this.name=null,this.body=null,this.type=null,this.name=e,this.body=t,this.type=o}return e.prototype.getName=function(){return this.name},e.prototype.setBody=function(e){this.body=e},e.prototype.getBody=function(){return this.body},e.prototype.setType=function(e){this.type=e},e.prototype.getType=function(){return this.type},e.prototype.toString=function(){var e="Notification Name: "+this.getName();return e+="\nBody:"+(null==this.getBody()?"null":this.getBody().toString()),e+="\nType:"+(null==this.getType()?"null":this.getType())},e}();e.Notification=t,__reflect(t.prototype,"AGame.Notification",["AGame.INotification"])}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function t(e,t,o){this.notify=null,this.context=null,this.other=null,this.setNotifyMethod(e),this.setNotifyContext(t),this.setNotifyOther(o)}return t.prototype.getNotifyMethod=function(){return this.notify},t.prototype.setNotifyMethod=function(e){this.notify=e},t.prototype.getNotifyOther=function(){return this.other},t.prototype.setNotifyOther=function(e){this.other=e},t.prototype.getNotifyContext=function(){return this.context},t.prototype.setNotifyContext=function(e){this.context=e},t.prototype.notifyObserver=function(t){var o=this.getNotifyOther(),n=this.getNotifyContext();this.getNotifyMethod().call(n,t,o),o&&o._isOnly&&e.ServiceBuilder.Instance.removeProxy(n)},t.prototype.compareNotifyContext=function(e){return e===this.context},t}();e.Observer=t,__reflect(t.prototype,"AGame.Observer",["AGame.IObserver"])}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function e(){this.m_pObserverMap={}}return e.prototype.registerObserver=function(e,t){var o=this.m_pObserverMap[e];o?o.push(t):this.m_pObserverMap[e]=[t]},e.prototype.removeObserver=function(e,t){var o=this.m_pObserverMap[e];if(o){for(var n=o.length;n--;){var r=o[n];if(r.compareNotifyContext(t)){o.splice(n,1);break}}0==o.length&&delete this.m_pObserverMap[e]}},e.prototype.notifyObservers=function(e){var t=e.getName(),o=this.m_pObserverMap[t];if(o)for(var n=o.slice(0),r=n.length,i=0;r>i;i++){var s=n[i];s.notifyObserver(e)}},e}();e.HandlerObserver=t,__reflect(t.prototype,"AGame.HandlerObserver",["AGame.IHandlerObserver"]);var o=function(){function o(){if(this.m_pCommandMap=null,o.instance)throw Error(o.SINGLETON_MSG);o.instance=this,this.m_pCommandMap={},this.initializeRouter()}return o.prototype.getObserver=function(){return this.m_pObserver},o.prototype.initializeRouter=function(){this.m_pObserver=new t},o.prototype.executeRouter=function(e){var t=this.m_pCommandMap[e.getName()];if(t){var o=new t;o.execute(e)}},o.prototype.registerRouter=function(t,o){this.m_pCommandMap[t]||this.m_pObserver.registerObserver(t,new e.Observer(this.executeRouter,this)),this.m_pCommandMap[t]=o},o.prototype.hasRouter=function(e){return null!=this.m_pCommandMap[e]},o.prototype.removeRouter=function(e){this.hasRouter(e)&&(this.m_pObserver.removeObserver(e,this),delete this.m_pCommandMap[e])},o.prototype.notifyObservers=function(e){this.m_pObserver.notifyObservers(e)},Object.defineProperty(o,"Instance",{get:function(){return o.instance||(o.instance=new o),o.instance},enumerable:!0,configurable:!0}),o.SINGLETON_MSG="Router singleton already constructed!",o}();e.Router=o,__reflect(o.prototype,"AGame.Router",["AGame.IRouter"])}(AGame||(AGame={}));var Client=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.m_pLoadControl=null,t}return __extends(t,e),t.prototype.createChildren=function(){AGame.NativeHelper.initExternalInterface(),e.prototype.createChildren.call(this),this.m_pLoadControl=new AGame.LoadControl(this),this.setDefFont(),this.loadConfig()},t.prototype.loadConfig=function(){var e=new AssetAdapter;this.stage.registerImplementation("eui.IAssetAdapter",e),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.setMaxLoadingThread(6),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),GameConst.isNative()?(console.assert||(console.assert=function(){return!0}),AGame.ResUtils.loadConfig("resource/default.res.json","resource/")):AGame.ResUtils.loadConfig(GameConst.RES_SERVER_CNF+"default.res.json?v="+GameConst.VERSION,GameConst.RES_SERVER_CNF)},t.prototype.onConfigComplete=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),this.m_pLoadControl.setComplete(LoadingEnum.ResConfig),this.doLoadLanuchRes()},t.prototype.onResourceLoadComplete=function(e){debug("onResourceLoadComplete----------"+e),"lanuch"==e?(this.createLoading(),this.doLoadGameJs()):"proto"==e&&this.m_pLoadControl.setComplete(LoadingEnum.Proto)},t.prototype.onThemeLoadComplete=function(){debug("onResourceLoadComplete----------Theme"),this.m_pLoadControl.setComplete(LoadingEnum.Theme)},t.prototype.onResourceLoadProgress=function(e,t){},t.prototype.doLoadLanuchRes=function(){AGame.ResUtils.loadGroups([["lanuch",9],["proto","0"]],this.onResourceLoadComplete,this.onResourceLoadProgress,this)},t.prototype.doLoadTheme=function(){GameConst.isNative()?AGame.ThemeUtils.load("resource/default.thm.json",this.stage,this.onThemeLoadComplete,this,!1):AGame.ThemeUtils.load(GameConst.RES_SERVER_CNF+"default.thm.json?v="+GameConst.VERSION,this.stage,this.onThemeLoadComplete,this,!1)},t.prototype.doLoadGameJs=function(){var e=AGame.GameMain,t=this;e?(t.doLoadTheme(),t.m_pLoadControl.setComplete(LoadingEnum.Code)):egret_h5.loadScript(GameConst.asynchScripts,function(){t.doLoadTheme(),t.m_pLoadControl.setComplete(LoadingEnum.Code)})},t.prototype.createLoading=function(){if(this.m_pLoadControl.createLoginView(),!GameConst.isNative()){var e=document.getElementById("preloading");e&&(e.style.display="none")}},t.prototype.setDefFont=function(){if(GameConst.isNative()){if(RES.hasRes("lgzbFont_ttf")){var e=RES.getVersionController().getVirtualUrl("resource/fonts/lgzbFont.ttf");GameConst.fontFamily=e}}else if(GameConst.isLoadFNT)GameConst.fontFamily="lgzbFont";else{var t=egret.Capabilities.os;"iOS"==t?GameConst.fontFamily="Helvetica":"Android"==t?GameConst.fontFamily="Droid Sans Fallback":GameConst.fontFamily="SimHei"}egret.TextField.default_fontFamily=GameConst.fontFamily},t.prototype.removeControl=function(){this.m_pLoadControl&&(this.m_pLoadControl.clearAll(),this.m_pLoadControl=null)},t.prototype.reloadGame=function(){GameConst.isShowLogin=!1,this.m_pLoadControl=new AGame.LoadControl(this),this.createLoading(),this.m_pLoadControl.setComplete(LoadingEnum.Proto),this.m_pLoadControl.setComplete(LoadingEnum.ResConfig),this.m_pLoadControl.setComplete(LoadingEnum.Code),this.m_pLoadControl.setComplete(LoadingEnum.Theme),this.m_pLoadControl.setComplete(LoadingEnum.Resource)},t}(eui.UILayer);__reflect(Client.prototype,"Client");var AGame;!function(e){var t=function(){function t(){this.m_bIsConnected=!1,this.m_bIsShowClose=!0,this.m_pSocket=new egret.WebSocket,this.m_pSocket.type=egret.WebSocket.TYPE_BINARY,this.m_pSocket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceive,this),this.m_pSocket.addEventListener(egret.Event.CONNECT,this.onConnected,this),this.m_pSocket.addEventListener(egret.Event.CLOSE,this.onClose,this),this.m_pSocket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this.m_pHeartbeatTimer=new egret.Timer(1e3*t.TIMER,0),this.m_pHeartbeatTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this)}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype.onReceive=function(){var t=new egret.ByteArray;this.m_pSocket.readBytes(t);var o=new e.Packet;o.onReacive(t);var n=e.ServiceBuilder.decode(o.protocol,o.buffer.buffer);e.ServiceBuilder.notifyProtoHandler(o.protocol,n),o.onClear()},t.prototype.onConnected=function(){console.log("onConnected"),this.m_bIsConnected=!0,this.m_bIsShowClose=!0,e.ServiceBuilder.notifyProtoHandler(t.CONNECTED_LOGIN)},t.prototype.close=function(){this.m_bIsConnected&&(this.m_bIsShowClose=!1),this.m_pSocket.close(),this.onClose(!1)},t.prototype.onClose=function(o){void 0===o&&(o=!0),this.m_bIsConnected=!1,this.stopHeartbeat(),e.ServiceBuilder.notifyProtoHandler(t.CONNECTED_CLOSE),this.onClear()},t.prototype.onClear=function(){this.m_pSocket&&(this.m_pSocket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceive,this),this.m_pSocket.removeEventListener(egret.Event.CONNECT,this.onConnected,this),this.m_pSocket.removeEventListener(egret.Event.CLOSE,this.onClose,this),this.m_pSocket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this.m_pSocket=null,t._instance=null)},t.prototype.onError=function(){this.m_bIsConnected=!1},t.prototype.setConnectInfo=function(e,t){this.m_pIp=e,this.m_iPort=t},t.prototype.connect=function(){this.m_pSocket.connect(this.m_pIp,this.m_iPort)},t.prototype.sendProtocol=function(t,o){var n=new e.Packet;n.onWrite(t,o),this.sendBytes(n.buffer),n.onClear()},t.prototype.sendBytes=function(e){this.m_pSocket.writeBytes(e),this.m_pSocket.flush()},t.prototype.isConnected=function(){return this.m_bIsConnected},t.prototype.startHeartbeat=function(){this.onTimer(),this.m_pHeartbeatTimer.start()},t.prototype.stopHeartbeat=function(){this.m_pHeartbeatTimer.stop()},t.prototype.onTimer=function(){e.HeartbeatQueue.timer(t.TIMER)},t.CONNECTED_LOGIN=500001,t.CONNECTED_CLOSE=500002,t.TIMER=30,t}();e.ASocket=t,__reflect(t.prototype,"AGame.ASocket")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function e(){}return e.prototype.paramsBuilder=function(e){var t=[];if("object"==typeof e){var o;for(o in e)t.push(o+"="+e[o]);return t.join("&")}return"string"==typeof e?e:""},e.prototype.send=function(t,o,n,r,i){void 0===i&&(i=egret.HttpResponseType.TEXT),this.returnFunc=o,this.target=n,this.request=new egret.HttpRequest;var s=this.request,a=this.paramsBuilder(r),p=e.serverUrl;t==egret.HttpMethod.POST?s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):(p+="?"+a,a=""),console.log(p),s.responseType=i,s.open(p,t),s.send(r),s.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),s.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),s.addEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this)},e.prototype.onGetComplete=function(e){var t=e.currentTarget,o="JSON"==this.responseType?JSON.parse(t.response):t.response;null!=this.returnFunc&&this.returnFunc.call(this.target,o),this.destory()},e.prototype.onGetIOError=function(e){console.log("get error : "+e),this.destory()},e.prototype.onGetProgress=function(e){console.log("get progress : "+Math.floor(100*e.bytesLoaded/e.bytesTotal)+"%")},e.prototype.destory=function(){var e=this.request;e.removeEventListener(egret.Event.COMPLETE,this.onGetComplete,this),e.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this),e.removeEventListener(egret.ProgressEvent.PROGRESS,this.onGetProgress,this),this.returnFunc=null,this.request=null},e.get=function(t,o,n,r){void 0===r&&(r="JSON");var i=new e;i.responseType=r,i.send(egret.HttpMethod.GET,t,o,n)},e.getArrayBuffer=function(t,o,n){var r=new e;r.responseType=egret.HttpResponseType.ARRAY_BUFFER,r.send(egret.HttpMethod.GET,t,o,n,egret.HttpResponseType.ARRAY_BUFFER)},e.post=function(t,o,n,r){void 0===r&&(r="JSON");var i=new e;i.responseType=r,i.send(egret.HttpMethod.POST,t,o,n)},e}();e.HttpClient=t,__reflect(t.prototype,"AGame.HttpClient")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function e(){this.buffer=new egret.ByteArray}return e.prototype.onReacive=function(e){e.position=3,this.protocol=e.readShort(),e.readBytes(this.buffer,0,e.length-5)},e.prototype.onWrite=function(t,o){var n=new egret.ByteArray(o.toArrayBuffer());this.buffer.writeByte(e.HEAD),this.buffer.writeShort(n.length+2),this.buffer.writeShort(t),this.buffer.writeBytes(n)},e.prototype.onClear=function(){this.buffer.clear()},e.HEAD=124,e}();e.Packet=t,__reflect(t.prototype,"AGame.Packet")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function e(){var e=RES.getRes("game_proto");this.m_pBuilder=dcodeIO.ProtoBuf.loadProto(e)}return e.prototype.getClazz=function(e){return this.m_pBuilder.build(e)},e.prototype.newClazz=function(e,t){var o=this.getClazz(t),n=new o;return n.protocol=e,n},e.prototype.decode=function(e,t){var o=this.getClazz(e);return o?o.decode(t):(egret.error("协议解析错误",e,t),null)},e}();__reflect(t.prototype,"ProtoBuilder");var o=function(){function o(){this.m_pBuilder=new t,this.m_pObserver=new e.HandlerObserver,this.m_pProtocolMap={},this.m_pViewEvents={}}return o.prototype.register=function(e,t,o,n){void 0===n&&(n=null),n?this.m_pProtocolMap[e]=[t,o,n]:this.m_pProtocolMap[e]=[t,o]},o.prototype.notifyModel=function(t,o){if(this.m_pProtocolMap[t]){var n=this.getProtoModel(t);n&&n.execute&&n.execute(new e.Notification(t,o))}},o.prototype.registerProxy=function(t,o,n,r){if(o){var i=this.m_pViewEvents[n.hashCode];if(i&&i.indexOf(t)>-1)return;this.m_pObserver.registerObserver(t,new e.Observer(o,n,r)),i?i.push(t):this.m_pViewEvents[n.hashCode]=[t]}},o.prototype.notifyProxy=function(e){this.m_pObserver.notifyObservers(e)},o.prototype.removeProxy=function(e){var t=this.m_pViewEvents[e.hashCode];if(t){for(var o=0;o<t.length;o++)this.m_pObserver.removeObserver(t[o],e);delete this.m_pViewEvents[e.hashCode]}},o.prototype.getProtoModel=function(e){return this.m_pProtocolMap[e][0]},o.prototype.getProtoByReq=function(e){this.m_pProtocolMap[e];return this.m_pProtocolMap[e][1]},o.prototype.getProtoByResp=function(e){var t=this.m_pProtocolMap[e];return t?2==t.length?t[1]:t[2]:null},o.prototype.newClazz=function(e){return this.m_pBuilder.newClazz(e,this.getProtoByReq(e))},o.prototype.decode=function(e,t){var o=this.getProtoByResp(e);return o?this.m_pBuilder.decode(o,t):(egret.error("协议解析错误",e,t),null)},o.prototype.decode_name=function(e,t){return this.m_pBuilder.decode(e,t)},Object.defineProperty(o,"Instance",{get:function(){return o._instance||(o._instance=new o),o._instance
},enumerable:!0,configurable:!0}),o.addProtoHandler=function(e,t,n,r){void 0===r&&(r=null),o.Instance.register(e,t,n,r)},o.notifyProtoHandler=function(e,t){o.Instance.notifyModel(e-o.REQ_RESP_DIFF,t)},o.notifyView=function(e){o.Instance.notifyProxy(e)},o.newClazz=function(e){return o.Instance.newClazz(e)},o.decode=function(e,t){return o.Instance.decode(e,t)},o.decode_name=function(e,t){return o.Instance.decode_name(e,t)},o.requestWithProtocol=function(e,t,n){this.sendMessage(o.Instance.newClazz(e),t,n)},o.sendMessage=function(t,n,r,i){o.Instance.registerProxy(t.protocol,n,r,i),e.ASocket.getInstance().sendProtocol(t.protocol,t)},o.sendOnlyMessage=function(e,t,o,n){n||(n={}),n._isOnly=!0,this.sendMessage(e,t,o,n)},o.REQ_RESP_DIFF=0,o}();e.ServiceBuilder=o,__reflect(o.prototype,"AGame.ServiceBuilder")}(AGame||(AGame={}));var AGame;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.skinName=t.getSkinXml(),t}return __extends(t,e),t.prototype.showNotice=function(e){this.lbl_text.text=e},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2},t.prototype.getSkinXml=function(){return'<?xml version="1.0" encoding="utf-8"?>\n<e:Skin class="NoticeView" width="530" height="330" xmlns:e="http://ns.egret.com/eui" xmlns:w="http://ns.egret.com/wing" xmlns:ns1="*">\n	<e:Group width="100%" height="100%" x="0" y="0">\n		<e:Image width="100%" height="100%" x="0" y="0" scaleX="1" scaleY="1" source="kCommon_dikuang_bg_png" scale9Grid="18,18,46,34"/>\n		<e:Group id="Group_Content" width="460" height="80" anchorOffsetY="0" verticalCenter="-10" anchorOffsetX="0" horizontalCenter="0">\n			<e:Label id="lbl_text" text="" y="14" size="21" horizontalCenter="0" x="73" scaleX="1" scaleY="1" stroke="2" width="100%" textAlign="center" verticalAlign="middle"/>\n		</e:Group>\n		<e:Image source="kComon_mbhw_png" width="96%" y="19" height="28" scaleX="1" scaleY="1" x="10"/>\n		<e:Image width="96%" y="7.33" x="9" source="kUpdate_mbhw_g1_png" anchorOffsetY="0" scaleX="1" scaleY="1"/>\n		<e:Label id="lbl_title" text="公告" y="13.33" size="28" textAlign="center" verticalAlign="middle" height="26" horizontalCenter="4.5" anchorOffsetX="0" stroke="1.4" x="202" scaleX="1" scaleY="1" textColor="0xfbd796"/>\n	</e:Group>\n</e:Skin>'},t}(eui.Component);e.NoticeView=t,__reflect(t.prototype,"AGame.NoticeView")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function e(){}return e.setData=function(e,t){egret.localStorage.setItem(e,t)},e.getData=function(e){var t;return t=egret.localStorage.getItem(e),t?t:""},e.removeData=function(e){egret.localStorage.removeItem(e)},e.removeOpenId=function(){egret.localStorage.removeItem(this.OPEN_ID)},e.setOpenId=function(e){this.setData(this.OPEN_ID,e)},e.setServerId=function(e){this.setData(this.SERVER_ID,e)},e.getOpenId=function(){var e=this.getData(this.OPEN_ID);return e||(e=this.getRandomId()),this.setData(this.OPEN_ID,e),e},e.getServerId=function(){var e=this.getData(this.SERVER_ID)||GameConst.getServerId();return this.setData(this.SERVER_ID,e),e},e.getIsDebug=function(){var e="h5sdk.isDebug",t=this.getData(e)||0;return this.setData(e,t),1==t},e.getRandomId=function(){var e="Temp"+Math.floor((new Date).getTime()/1e3);return e},e.OPEN_ID="h5sdk.openid",e.SERVER_ID="h5sdk.serverid",e}();e.LocalData=t,__reflect(t.prototype,"AGame.LocalData")}(AGame||(AGame={}));var AGame;!function(e){var t=function(e){function t(t,o){void 0===t&&(t=1);var n=e.call(this)||this;return n.isActive=!0,n.isMoving=!1,n.nWaitingTime=0,n.nMoveTotalTime=2800,n.nDisplayTime=80,n.m_pSkinType=1,n.m_pSkinType=t,n.m_pSkinData=o,n.skinName=n.getSkinXml(),n}return __extends(t,e),t.prototype.getSkinXml=function(){return'<?xml version="1.0" encoding="utf-8"?>\n<e:Skin class="MessageTips1" width="233" height="50" xmlns:e="http://ns.egret.com/eui" xmlns:com_main="com_main.*" xmlns:ns1="*" xmlns:w="http://ns.egret.com/wing">\n	<e:Group width="100%" height="100%" x="0" y="0" touchChildren="false" touchEnabled="false">\n		<e:Label id="Lbl_text1" text="Label" textColor="0xe8dfc8" size="25" stroke="2" strokeColor="0x242222" verticalCenter="0" horizontalCenter="0"/>\n	</e:Group>\n</e:Skin>'},t.prototype.childrenCreated=function(){e.prototype.childrenCreated.call(this),this.touchEnabled=!1,this.touchChildren=!1,this.setLblInfo(),this.setData()},t.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),egret.Tween.removeTweens(this)},t.prototype.setData=function(){this.Lbl_text1.textColor=this.m_pSkinData.lbl1_color?this.m_pSkinData.lbl1_color:this.Lbl_text1.textColor,this.Lbl_text1.text=this.m_pSkinData.lbl1_msg},t.prototype.setLblInfo=function(e){void 0===e&&(e=o.MSG_START_Y),this.y=e+this.height/2,this.alpha=0,this.verticalCenter=0,this.horizontalCenter=0,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2},t.prototype.startTween=function(e,n,r){void 0===e&&(e=o.MSG_START_Y),void 0===n&&(n=t.tweenDist),void 0===r&&(r=t.tweenDuration),this.alpha=0,this.visible=!0,this.m_pAction=egret.Tween.get(this),this.m_pAction.to({alpha:1},300,egret.Ease.backInOut).wait(100).to({y:this.y-n},r).wait(100).to({scaleY:.5,alpha:0},400,egret.Ease.backOut).call(this.tweenComplete,this)},t.prototype.tweenComplete=function(){this.parent&&this.parent.removeChild(this),this.isActive=!1,this.m_pAction=null,o.clearQueue()},t.prototype.resetTween=function(e,o){void 0===o&&(o=1),egret.Tween.removeTweens(this),this.m_pAction=egret.Tween.get(this),this.y=e,this.alpha=1,this.scaleX=1,this.scaleY=1;var n=t.tweenDist*o,r=t.tweenDuration*o;this.m_pAction=egret.Tween.get(this),this.m_pAction.to({y:this.y-n},r).wait(100).to({scaleY:.4,alpha:0},400).call(this.tweenComplete,this)},t.prototype.stopTween=function(){egret.Tween.removeTweens(this)},t.tweenDist=40,t.tweenDuration=1200,t}(eui.Component);e.CUIMsg=t,__reflect(t.prototype,"AGame.CUIMsg");var o=function(){function t(){}return t.clearLast=function(){var e=this.m_pQueue;e.pop()},t.clearQueue=function(){for(var e,t=this.m_pQueue,o=t.length-1;o>=0;o--)e=t[o],e.isActive||t.splice(o,1)},t.needsLayout=function(){this.clearQueue();var e,t=this.m_pQueue;if(t.length>this.MAX_COUNT)for(var o=0;o<t.length-this.MAX_COUNT;o++)e=t[o],e.stopTween(),e.parent.removeChild(e),t.splice(0,1);if(t.length>0)for(var n,o=0;o<t.length-1;o++){var r=(o+1)/t.length;e=t[o],n=this.MSG_START_Y-(t.length-1-o)*e.height+e.height-10,e.resetTween(n,r)}},t.message=function(t,o,n){void 0===o&&(o=1),void 0===n&&(n=null);var r=new e.CUIMsg(o,n);r.visible=!1,this.m_pQueue.push(r),t.addChild(r),r.x=t.width/2,this.stage=t,this.needsLayout(),1==o||3==o||4==o||5==o?r.startTween(this.MSG_START_Y):2==o&&r.startTween(this.MSG_START_Y,40,1e3)},t.AddMessageInfo=function(e,t,o){void 0===o&&(o=this.ERR_COLOR);var n={lbl1_msg:t,lbl1_color:o};this.message(e,1,n)},t.AddMessageError=function(e,t,o){void 0===o&&(o=this.ERR_COLOR);var n={lbl1_msg:t,lbl1_color:o};this.message(e,1,n)},t.INFO_COLOR=15466495,t.ERR_COLOR=16203302,t.MAX_COUNT=4,t.MSG_START_Y=320,t.m_pQueue=[],t.m_pTempList=[],t}();e.CMessageTip=o,__reflect(o.prototype,"AGame.CMessageTip")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function e(){}return e.isNative=function(){return egret.RuntimeType.NATIVE==egret.Capabilities.runtimeType?!0:!1},e.initExternalInterface=function(){egret.ExternalInterface.addCallback("setAppOptions",function(t){egret.log("message form native setAppOptions: "+t),e.parseAppOptions(t)}),this.sendCodeInit()},e.parseAppOptions=function(e){var t=JSON.parse(e);GameConst.VERSION=t.version,GameConst.DEBUG=t.debug?!0:!1},e.sendCodeInit=function(){egret.ExternalInterface.call("codeInit","")},e.sendEnterGame=function(e){egret.ExternalInterface.call("enterGame",e)},e}();e.NativeHelper=t,__reflect(t.prototype,"AGame.NativeHelper")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function t(){}return t.userLogin=function(t,o){e.HttpClient.serverUrl=GameConst.serverHost+"/api/user/login";var n={};n.platform=GameConst.platform,n.open_id=e.LocalData.getOpenId(),n.device_type=GameConst.deviceType(),n.version=GameConst.VERSION,e.HttpClient.get(t,o,n)},t.getServerList=function(t,o){e.HttpClient.serverUrl=GameConst.serverHost+"/api/server/lists";var n={};n.platform=GameConst.platform,n.open_id=e.LocalData.getOpenId(),n.device_type=GameConst.deviceType(),n.version=GameConst.VERSION,e.HttpClient.get(t,o,n)},t.sendRoleInfo=function(){e.HttpClient.serverUrl=GameConst.serverHost+"/api/user/role_info";var t=egret.getDefinitionByName("RoleData"),o={};o.rid=t.accountId,o.open_id=e.LocalData.getOpenId(),o.nickname=t.nickName,o.server_id=GameConst.serverId,o.version=GameConst.VERSION,o.platform=GameConst.platform,o.create_time=GameConst.platform,o.device_type=GameConst.deviceType(),o.create_time=GameConst.createTime,o.token=GameConst.sign,e.HttpClient.get(this.callSendRolaInfo,this,o)},t.callSendRolaInfo=function(e){debug("callSendRolaInfo",e)},t}();e.PlatformUtils=t,__reflect(t.prototype,"AGame.PlatformUtils")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function e(){this.m_pGroups=[],this.length=0,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this)}return e.prototype.destroy=function(){RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this);for(var e,t=0;t<this.m_pGroups.length;t++)e=this.m_pGroups[t],e[0]=null,e[1]=null,e[2]=null;this.m_pGroups.length=0,this.length=0},e.prototype.loadGroup=function(e,t,o,n,r){this.m_pGroups[e]=[t,o,n],RES.loadGroup(e,r)},e.prototype.loadGroups=function(e,t,o,n){for(var r,i=0;i<e.length;i++)r=e[i],this.length+=RES.getGroupByName(r[0]).length,this.loadGroup(r[0],t,o,n,r[1])},e.prototype.onResourceLoadComplete=function(e){var t=this.m_pGroups[e.groupName];if(t){var o=t[0],n=t[2];null!=o&&o.call(n,e.groupName),t=null,delete this.m_pGroups[e.groupName]}var r=Object.keys(this.m_pGroups);r.length<=0&&this.destroy()},e.prototype.onResourceLoadError=function(e){this.onResourceLoadComplete(e)},e.prototype.onResourceProgress=function(e){var t=this.m_pGroups[e.groupName];if(t){var o=t[1],n=t[2];null!=o&&o.call(n,e.itemsLoaded,e.itemsTotal)}},e.prototype.onItemLoadError=function(e){console.warn("Url:"+e.resItem.url+" has failed to load")},e}();e.ResLoader=t,__reflect(t.prototype,"AGame.ResLoader");var o=function(){function e(){}return e.loadConfig=function(e,t,o){RES.loadConfig(e,t,o)},e.loadGroups=function(e,o,n,r){var i=new t;return i.loadGroups(e,o,n,r),i.length},e}();e.ResUtils=o,__reflect(o.prototype,"AGame.ResUtils")}(AGame||(AGame={}));var AGame;!function(e){var t=function(){function e(){}return e.addSkin=function(e,t,o){this.m_pSkinMap[e]={},this.m_pSkinMap[e].exml=t,o&&this.getSkinFunc(e)},e.getTheme=function(e){var t;if("function"==typeof e)return e;if(e.indexOf("<?xml version='1.0' encoding='utf-8'?>")>-1)return EXML.$parseURLContent("",e);if(e.indexOf("/")>-1){var o=e.split("/");t=o[o.length-1].replace(".exml","")}else t=e.replace(".exml","");return this.getSkinFunc(t)},e.getDependenceSkins=function(e,t){if(!this.disableDependence){for(var o=function(e){return"Group"==e||"ViewStack"==e||"Panel"==e||"Scroller"==e},n=0,r=e.children,i=[];n<r.length;n++)("dfh3"==r[n].prefix||o(r[n].localName))&&i.push(r[n]);if(i.length<=0||t>5)return void(t>5&&console.warn("getDependenceSkins 递归层数太高，请检查皮肤参数"));for(n=0;n<i.length;n++){var s=i[n];if(o(s.localName))for(var a=0;a<s.children.length;a++)this.getDependenceSkins(s.children[a],t+1);if("dfh3"==s.prefix){var p=s.attributes.skinName;p&&(console.log("~!@#getDependenceSkins name="+p+" depth="+(t+1)),this.getSkinFunc(p,t+1))}}}},e.getSkinFunc=function(e,t){void 0===t&&(t=0);var o=this.m_pSkinMap[e].exml;if(o){if(!this.disableDependence){var n=egret.XML.parse(o);this.getDependenceSkins(n,t)}this.m_pSkinMap[e].func=EXML.$parseURLContent("",o),delete this.m_pSkinMap[e].exml}return this.m_pSkinMap[e].func},e.destroy=function(){this.m_pSkinBytes=null,this.m_pSkinMap=null,this.m_pPosition=0},e.m_pSkinBytes=new egret.ByteArray,e.m_pSkinMap={},e.m_pPosition=0,e.disableDependence=!0,e}();__reflect(t.prototype,"CCSkinCache");var o=function(e){function o(t,o,n,r,i){var s=this;return i?(s=e.call(this,"",o)||this,s.$url=t,s.loadTheme(t,o)):s=e.call(this,t,o)||this,s.$onThemeLoadComplete=n,s.$target=r,s.addEventListener(eui.UIEvent.COMPLETE,s.onThemeLoadComplete,s),s}return __extends(o,e),o.prototype.onThemeLoadComplete=function(){this.$target&&this.$onThemeLoadComplete&&this.$onThemeLoadComplete.call(this.$target),this.removeEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this)},o.prototype.loadTheme=function(e,t){var o=t?t.getImplementation("eui.IThemeAdapter"):null;o||(o=new eui.DefaultThemeAdapter),o.getTheme(e,this.onThemeLoaded,this.onThemeLoaded,this)},o.prototype.onThemeLoaded=function(e){var t=this;if(e)if(GameConst.DEBUG)try{var o=JSON.parse(e)}catch(n){egret.$error(3e3,"on Theme parse error",e)}else var o=JSON.parse(e);else GameConst.DEBUG&&egret.$error(3e3,"on Theme parse error",this.$url,e);var r=o.exmls[0].content?!0:!1;o.exmls.forEach(function(e,n,i){return t.parseURLContent(e,r,o.skins,i)}),this.dispatchEventWith(egret.Event.COMPLETE)},o.prototype.parseURLContent=function(e,o,n,r){var i,s;o?(i=e.path,s=e.content):(i=e,s=e);var a=i.split("/"),p=a[a.length-1].replace(".exml","");t.addSkin(p,s,n[p])},o}(eui.Theme);__reflect(o.prototype,"CCTheme");var n=function(){function e(){}return e.load=function(e,t,n,r,i){new o(e,t,n,r,i)},e.getTheme=function(e){return t.getTheme(e)},e.setSkinFunc=function(e,t){var o=e.$Component;if(o[5]=!0,o[1]!=t){if(t)o[1]=t;else if(e.$stage){var n=e.$stage.getImplementation("eui.Theme");if(n){var r=n.getSkinName(e);r&&(o[1]=r)}}e.$parseSkinName()}},e}();e.ThemeUtils=n,__reflect(n.prototype,"AGame.ThemeUtils")}(AGame||(AGame={}));var MainMenu=function(e){function t(){var t=e.call(this)||this;return t.skinName="resource/skins/MainMenuSkin.exml",t}return __extends(t,e),t.prototype.startCreateScene=function(){var e=this.createBitmapByName("bg_jpg");this.addChild(e);var t=this.stage.stageWidth,o=this.stage.stageHeight;e.width=t,e.height=o;var n=new egret.Shape;n.graphics.beginFill(0,.5),n.graphics.drawRect(0,0,t,172),n.graphics.endFill(),n.y=33,this.addChild(n);var r=this.createBitmapByName("egret_icon_png");this.addChild(r),r.x=26,r.y=33;var i=new egret.Shape;i.graphics.lineStyle(2,16777215),i.graphics.moveTo(0,0),i.graphics.lineTo(0,117),i.graphics.endFill(),i.x=172,i.y=61,this.addChild(i);var s=new egret.TextField;s.textColor=16777215,s.width=t-172,s.textAlign="center",s.text="Hello Egret",s.size=24,s.x=172,s.y=80,this.addChild(s);var a=new egret.TextField;this.addChild(a),a.alpha=0,a.width=t-172,a.textAlign=egret.HorizontalAlign.CENTER,a.size=24,a.textColor=16777215,a.x=172,a.y=135,this.textfield=a,RES.getResAsync("description_json",this.startAnimation,this);var p=new eui.Button;p.label="Click!",p.horizontalCenter=0,p.verticalCenter=0,this.addChild(p),p.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onButtonClick,this)},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,o=RES.getRes(e);return t.texture=o,t},t.prototype.startAnimation=function(e){var t=this,o=new egret.HtmlTextParser,n=e.map(function(e){return o.parse(e)}),r=this.textfield,i=-1,s=function(){i++,i>=n.length&&(i=0);var e=n[i];r.textFlow=e;var o=egret.Tween.get(r);o.to({alpha:1},200),o.wait(2e3),o.to({alpha:0},200),o.call(s,t)};s()},t.prototype.onButtonClick=function(e){var t=new eui.Panel;t.title="Title",t.horizontalCenter=0,t.verticalCenter=0,this.addChild(t)},t}(eui.Component);__reflect(MainMenu.prototype,"MainMenu");